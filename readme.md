Most of the code is derived from MSDN community and winAPI programming reference.
